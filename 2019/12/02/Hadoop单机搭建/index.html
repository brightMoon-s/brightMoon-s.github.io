<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>Hadoop+Hive单机搭建 | 浩瀚星空 Blog</title><meta name="description" content="Hadoop+Hive单机搭建"><meta name="keywords" content="Hadoop"><meta name="author" content="Starlight"><meta name="copyright" content="Starlight"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Hadoop+Hive单机搭建"><meta name="twitter:description" content="Hadoop+Hive单机搭建"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png"><meta property="og:type" content="article"><meta property="og:title" content="Hadoop+Hive单机搭建"><meta property="og:url" content="https://brightmoon-s.github.io/2019/12/02/Hadoop%E5%8D%95%E6%9C%BA%E6%90%AD%E5%BB%BA/"><meta property="og:site_name" content="浩瀚星空 Blog"><meta property="og:description" content="Hadoop+Hive单机搭建"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://brightmoon-s.github.io/2019/12/02/Hadoop%E5%8D%95%E6%9C%BA%E6%90%AD%E5%BB%BA/"><link rel="prev" title="Spark2.4.5源码编译安装" href="https://brightmoon-s.github.io/2020/03/06/Spark2-4-5%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85/"><link rel="next" title="MySQL5.7单机部署" href="https://brightmoon-s.github.io/2019/02/12/MySQL5-7%E5%8D%95%E6%9C%BA%E9%83%A8%E7%BD%B2/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  isHome: false,
  isPost: true
  
}</script><meta name="generator" content="Hexo 4.2.0"></head><body><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">浩瀚星空 Blog</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div></div></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">3</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">3</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#Hadoop配置"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">Hadoop配置</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-6"><a class="toc_mobile_items-link" href="#创建hadoop001用户"><span class="toc_mobile_items-number">1.0.0.0.0.1.</span> <span class="toc_mobile_items-text">创建hadoop001用户</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-6"><a class="toc_mobile_items-link" href="#创建-bigdata文件夹，用来安装hadoop，其中-usr-java为jdk安装目录，JAVA部署必须是-usr-java-与CDH环境配套"><span class="toc_mobile_items-number">1.0.0.0.0.2.</span> <span class="toc_mobile_items-text">创建&#x2F;bigdata文件夹，用来安装hadoop，其中&#x2F;usr&#x2F;java为jdk安装目录，JAVA部署必须是&#x2F;usr&#x2F;java 与CDH环境配套</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-6"><a class="toc_mobile_items-link" href="#更改-bigdata用户及用户组为hadoop001"><span class="toc_mobile_items-number">1.0.0.0.0.3.</span> <span class="toc_mobile_items-text">更改&#x2F;bigdata用户及用户组为hadoop001</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#查询本地IP地址并配置hosts文件，192-168-0-3是内网IP，不能配置外网IP"><span class="toc_mobile_items-number">1.0.0.0.1.</span> <span class="toc_mobile_items-text">查询本地IP地址并配置hosts文件，192.168.0.3是内网IP，不能配置外网IP</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-6"><a class="toc_mobile_items-link" href="#在-bigdata目录下，创建以下目录"><span class="toc_mobile_items-number">1.0.0.0.1.1.</span> <span class="toc_mobile_items-text">在&#x2F;bigdata目录下，创建以下目录</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-6"><a class="toc_mobile_items-link" href="#下载jdk1-8安装包到-bigdata-software目录下，解压到-usr-java目录下"><span class="toc_mobile_items-number">1.0.0.0.1.2.</span> <span class="toc_mobile_items-text">下载jdk1.8安装包到&#x2F;bigdata&#x2F;software目录下，解压到&#x2F;usr&#x2F;java目录下</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-6"><a class="toc_mobile_items-link" href="#下载Hadoop安装包到-bigdata-software目录，并解压到-bigdata-app"><span class="toc_mobile_items-number">1.0.0.0.1.3.</span> <span class="toc_mobile_items-text">下载Hadoop安装包到&#x2F;bigdata&#x2F;software目录，并解压到&#x2F;bigdata&#x2F;app&#x2F;</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#做Hadoop软连接，如果版本升级修改方便，脚本使用简便。"><span class="toc_mobile_items-number">1.0.0.0.2.</span> <span class="toc_mobile_items-text">做Hadoop软连接，如果版本升级修改方便，脚本使用简便。</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#环境变量配置，强烈建议使用-bashrc文件，不要配置-bash-profile，避免不必要的踩坑，并使配置文件生效，使用which命令验证环境变量是否生效"><span class="toc_mobile_items-number">1.0.0.0.3.</span> <span class="toc_mobile_items-text">环境变量配置，强烈建议使用.bashrc文件，不要配置.bash_profile，避免不必要的踩坑，并使配置文件生效，使用which命令验证环境变量是否生效</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#配置ssh信任关系"><span class="toc_mobile_items-number">1.0.0.0.4.</span> <span class="toc_mobile_items-text">配置ssh信任关系</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#配置hadoop001免密登录，如果输入yes出来时间就说明信任关系是OK的。如果有问题，说明前面SSH信任配置不对。"><span class="toc_mobile_items-number">1.0.0.0.5.</span> <span class="toc_mobile_items-text">配置hadoop001免密登录，如果输入yes出来时间就说明信任关系是OK的。如果有问题，说明前面SSH信任配置不对。</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#配置core-site-xml文件，让NN-SNN-DN都以hadoop001用户启动，而不是默认的0-0-0-0启动。"><span class="toc_mobile_items-number">1.0.0.0.6.</span> <span class="toc_mobile_items-text">配置core-site.xml文件，让NN SNN DN都以hadoop001用户启动，而不是默认的0.0.0.0启动。</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#配置hdfs-site-xml"><span class="toc_mobile_items-number">1.0.0.0.7.</span> <span class="toc_mobile_items-text">配置hdfs-site.xml</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#配置mapred-site-xml文件"><span class="toc_mobile_items-number">1.0.0.0.8.</span> <span class="toc_mobile_items-text">配置mapred-site.xml文件</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#配置yarn-site-xml"><span class="toc_mobile_items-number">1.0.0.0.9.</span> <span class="toc_mobile_items-text">配置yarn-site.xml</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#格式化HDFS文件系统"><span class="toc_mobile_items-number">1.0.0.0.10.</span> <span class="toc_mobile_items-text">格式化HDFS文件系统</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#修改hadoop-env-sh、mapred-env-sh、yarn-env-sh文件，默认进程PID文件写在系统tmp目录里，TMP目录有30天清理规则，过期无法执行关闭程序命令，只能kill杀进程。"><span class="toc_mobile_items-number">1.0.0.0.11.</span> <span class="toc_mobile_items-text">修改hadoop-env.sh、mapred-env.sh、yarn-env.sh文件，默认进程PID文件写在系统tmp目录里，TMP目录有30天清理规则，过期无法执行关闭程序命令，只能kill杀进程。</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#启动hadoop和yarn服务，关闭yarn和hadoop服务"><span class="toc_mobile_items-number">1.0.0.0.12.</span> <span class="toc_mobile_items-text">启动hadoop和yarn服务，关闭yarn和hadoop服务</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#执行hadoop命令，验证服务是否正常"><span class="toc_mobile_items-number">1.0.0.0.13.</span> <span class="toc_mobile_items-text">执行hadoop命令，验证服务是否正常</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#浏览器验证"><span class="toc_mobile_items-number">1.0.0.0.14.</span> <span class="toc_mobile_items-text">浏览器验证</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#Hive配置"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text">Hive配置</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#配置hive-site-xml，hadoop用户操作"><span class="toc_mobile_items-number">2.0.0.0.1.</span> <span class="toc_mobile_items-text">配置hive-site.xml，hadoop用户操作</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#启动hive并测试"><span class="toc_mobile_items-number">2.0.0.0.2.</span> <span class="toc_mobile_items-text">启动hive并测试</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></div></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Hadoop配置"><span class="toc-number">1.</span> <span class="toc-text">Hadoop配置</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#创建hadoop001用户"><span class="toc-number">1.0.0.0.0.1.</span> <span class="toc-text">创建hadoop001用户</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#创建-bigdata文件夹，用来安装hadoop，其中-usr-java为jdk安装目录，JAVA部署必须是-usr-java-与CDH环境配套"><span class="toc-number">1.0.0.0.0.2.</span> <span class="toc-text">创建&#x2F;bigdata文件夹，用来安装hadoop，其中&#x2F;usr&#x2F;java为jdk安装目录，JAVA部署必须是&#x2F;usr&#x2F;java 与CDH环境配套</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#更改-bigdata用户及用户组为hadoop001"><span class="toc-number">1.0.0.0.0.3.</span> <span class="toc-text">更改&#x2F;bigdata用户及用户组为hadoop001</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#查询本地IP地址并配置hosts文件，192-168-0-3是内网IP，不能配置外网IP"><span class="toc-number">1.0.0.0.1.</span> <span class="toc-text">查询本地IP地址并配置hosts文件，192.168.0.3是内网IP，不能配置外网IP</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#在-bigdata目录下，创建以下目录"><span class="toc-number">1.0.0.0.1.1.</span> <span class="toc-text">在&#x2F;bigdata目录下，创建以下目录</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#下载jdk1-8安装包到-bigdata-software目录下，解压到-usr-java目录下"><span class="toc-number">1.0.0.0.1.2.</span> <span class="toc-text">下载jdk1.8安装包到&#x2F;bigdata&#x2F;software目录下，解压到&#x2F;usr&#x2F;java目录下</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#下载Hadoop安装包到-bigdata-software目录，并解压到-bigdata-app"><span class="toc-number">1.0.0.0.1.3.</span> <span class="toc-text">下载Hadoop安装包到&#x2F;bigdata&#x2F;software目录，并解压到&#x2F;bigdata&#x2F;app&#x2F;</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#做Hadoop软连接，如果版本升级修改方便，脚本使用简便。"><span class="toc-number">1.0.0.0.2.</span> <span class="toc-text">做Hadoop软连接，如果版本升级修改方便，脚本使用简便。</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#环境变量配置，强烈建议使用-bashrc文件，不要配置-bash-profile，避免不必要的踩坑，并使配置文件生效，使用which命令验证环境变量是否生效"><span class="toc-number">1.0.0.0.3.</span> <span class="toc-text">环境变量配置，强烈建议使用.bashrc文件，不要配置.bash_profile，避免不必要的踩坑，并使配置文件生效，使用which命令验证环境变量是否生效</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#配置ssh信任关系"><span class="toc-number">1.0.0.0.4.</span> <span class="toc-text">配置ssh信任关系</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#配置hadoop001免密登录，如果输入yes出来时间就说明信任关系是OK的。如果有问题，说明前面SSH信任配置不对。"><span class="toc-number">1.0.0.0.5.</span> <span class="toc-text">配置hadoop001免密登录，如果输入yes出来时间就说明信任关系是OK的。如果有问题，说明前面SSH信任配置不对。</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#配置core-site-xml文件，让NN-SNN-DN都以hadoop001用户启动，而不是默认的0-0-0-0启动。"><span class="toc-number">1.0.0.0.6.</span> <span class="toc-text">配置core-site.xml文件，让NN SNN DN都以hadoop001用户启动，而不是默认的0.0.0.0启动。</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#配置hdfs-site-xml"><span class="toc-number">1.0.0.0.7.</span> <span class="toc-text">配置hdfs-site.xml</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#配置mapred-site-xml文件"><span class="toc-number">1.0.0.0.8.</span> <span class="toc-text">配置mapred-site.xml文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#配置yarn-site-xml"><span class="toc-number">1.0.0.0.9.</span> <span class="toc-text">配置yarn-site.xml</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#格式化HDFS文件系统"><span class="toc-number">1.0.0.0.10.</span> <span class="toc-text">格式化HDFS文件系统</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#修改hadoop-env-sh、mapred-env-sh、yarn-env-sh文件，默认进程PID文件写在系统tmp目录里，TMP目录有30天清理规则，过期无法执行关闭程序命令，只能kill杀进程。"><span class="toc-number">1.0.0.0.11.</span> <span class="toc-text">修改hadoop-env.sh、mapred-env.sh、yarn-env.sh文件，默认进程PID文件写在系统tmp目录里，TMP目录有30天清理规则，过期无法执行关闭程序命令，只能kill杀进程。</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#启动hadoop和yarn服务，关闭yarn和hadoop服务"><span class="toc-number">1.0.0.0.12.</span> <span class="toc-text">启动hadoop和yarn服务，关闭yarn和hadoop服务</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#执行hadoop命令，验证服务是否正常"><span class="toc-number">1.0.0.0.13.</span> <span class="toc-text">执行hadoop命令，验证服务是否正常</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#浏览器验证"><span class="toc-number">1.0.0.0.14.</span> <span class="toc-text">浏览器验证</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Hive配置"><span class="toc-number">2.</span> <span class="toc-text">Hive配置</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#配置hive-site-xml，hadoop用户操作"><span class="toc-number">2.0.0.0.1.</span> <span class="toc-text">配置hive-site.xml，hadoop用户操作</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#启动hive并测试"><span class="toc-number">2.0.0.0.2.</span> <span class="toc-text">启动hive并测试</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png)"><div id="post-info"><div id="post-title"><div class="posttitle">Hadoop+Hive单机搭建</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 发表于 2019-12-02<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> 更新于 2020-03-14</time><div class="post-meta-wordcount"><div class="post-meta-pv-cv"><span><i class="fa fa-eye post-meta__icon fa-fw" aria-hidden="true"> </i>阅读量:</span><span id="busuanzi_value_page_pv"></span></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><blockquote>
<p>以CDH 2.6.0-cdh5.16.2为例.<br>CDH版本下载地址：<a href="http://archive.cloudera.com/cdh5/cdh/5/" target="_blank" rel="noopener">http://archive.cloudera.com/cdh5/cdh/5/</a></p>
</blockquote>
<h1 id="Hadoop配置"><a href="#Hadoop配置" class="headerlink" title="Hadoop配置"></a>Hadoop配置</h1><h6 id="创建hadoop001用户"><a href="#创建hadoop001用户" class="headerlink" title="创建hadoop001用户"></a>创建hadoop001用户</h6><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># useradd hadoop001</span></span><br></pre></td></tr></table></figure></div>
<h6 id="创建-bigdata文件夹，用来安装hadoop，其中-usr-java为jdk安装目录，JAVA部署必须是-usr-java-与CDH环境配套"><a href="#创建-bigdata文件夹，用来安装hadoop，其中-usr-java为jdk安装目录，JAVA部署必须是-usr-java-与CDH环境配套" class="headerlink" title="创建/bigdata文件夹，用来安装hadoop，其中/usr/java为jdk安装目录，JAVA部署必须是/usr/java 与CDH环境配套"></a>创建/bigdata文件夹，用来安装hadoop，其中/usr/java为jdk安装目录，JAVA部署必须是/usr/java 与CDH环境配套</h6><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mkdir /bigdata</span></span><br><span class="line"><span class="comment"># mkdir /usr/java</span></span><br></pre></td></tr></table></figure></div>
<h6 id="更改-bigdata用户及用户组为hadoop001"><a href="#更改-bigdata用户及用户组为hadoop001" class="headerlink" title="更改/bigdata用户及用户组为hadoop001"></a>更改/bigdata用户及用户组为hadoop001</h6><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># chown hadoop001:hadoop001 /bigdata</span></span><br></pre></td></tr></table></figure></div>
<h5 id="查询本地IP地址并配置hosts文件，192-168-0-3是内网IP，不能配置外网IP"><a href="#查询本地IP地址并配置hosts文件，192-168-0-3是内网IP，不能配置外网IP" class="headerlink" title="查询本地IP地址并配置hosts文件，192.168.0.3是内网IP，不能配置外网IP"></a>查询本地IP地址并配置hosts文件，192.168.0.3是内网IP，不能配置外网IP</h5><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ip a s </span></span><br><span class="line"><span class="comment"># echo '192.168.0.3 hadoop001' &gt;&gt; /etc/hosts</span></span><br></pre></td></tr></table></figure></div>
<h6 id="在-bigdata目录下，创建以下目录"><a href="#在-bigdata目录下，创建以下目录" class="headerlink" title="在/bigdata目录下，创建以下目录"></a>在/bigdata目录下，创建以下目录</h6><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir app software sourcecode <span class="built_in">log</span> data tmp lib</span><br><span class="line"> <span class="comment">#app 解压后文件存储目录</span></span><br><span class="line"> <span class="comment">#data 存储数据目录</span></span><br><span class="line"> <span class="comment">#lib 第三方包目录</span></span><br><span class="line"> <span class="comment">#log  日志文件目录</span></span><br><span class="line"> <span class="comment">#software 安装包目录</span></span><br><span class="line"> <span class="comment">#sourcecode 源码目录</span></span><br><span class="line"> <span class="comment">#tmp 临时文件目录</span></span><br></pre></td></tr></table></figure></div>
<h6 id="下载jdk1-8安装包到-bigdata-software目录下，解压到-usr-java目录下"><a href="#下载jdk1-8安装包到-bigdata-software目录下，解压到-usr-java目录下" class="headerlink" title="下载jdk1.8安装包到/bigdata/software目录下，解压到/usr/java目录下"></a>下载jdk1.8安装包到/bigdata/software目录下，解压到/usr/java目录下</h6><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ tar -zxvf jdk1.8.0_231.tar.gz -C /usr/java/</span><br></pre></td></tr></table></figure></div>
<h6 id="下载Hadoop安装包到-bigdata-software目录，并解压到-bigdata-app"><a href="#下载Hadoop安装包到-bigdata-software目录，并解压到-bigdata-app" class="headerlink" title="下载Hadoop安装包到/bigdata/software目录，并解压到/bigdata/app/"></a>下载Hadoop安装包到/bigdata/software目录，并解压到/bigdata/app/</h6><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ wget http://archive.cloudera.com/cdh5/cdh/5/hadoop-2.6.0-cdh5.16.2.tar.gz</span><br><span class="line">$ wget http://archive.cloudera.com/cdh5/cdh/5/hive-1.1.0-cdh5.16.2.tar.gz</span><br><span class="line">$ tar -zxvf hadoop-2.6.0-cdh5.16.2.tar.gz -C /bigdata/app</span><br><span class="line">$ tar -zxvf hive-1.1.0-cdh5.16.2.tar.gz -C /bigdata/app</span><br></pre></td></tr></table></figure></div>
<h5 id="做Hadoop软连接，如果版本升级修改方便，脚本使用简便。"><a href="#做Hadoop软连接，如果版本升级修改方便，脚本使用简便。" class="headerlink" title="做Hadoop软连接，如果版本升级修改方便，脚本使用简便。"></a>做Hadoop软连接，如果版本升级修改方便，脚本使用简便。</h5><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> /bigdata/app</span><br><span class="line">$ ln -s hadoop-2.6.0-cdh5.16.2 hadoop</span><br><span class="line">$ ln -s hive-1.1.0-cdh5.16.2 hive</span><br></pre></td></tr></table></figure></div>
<h5 id="环境变量配置，强烈建议使用-bashrc文件，不要配置-bash-profile，避免不必要的踩坑，并使配置文件生效，使用which命令验证环境变量是否生效"><a href="#环境变量配置，强烈建议使用-bashrc文件，不要配置-bash-profile，避免不必要的踩坑，并使配置文件生效，使用which命令验证环境变量是否生效" class="headerlink" title="环境变量配置，强烈建议使用.bashrc文件，不要配置.bash_profile，避免不必要的踩坑，并使配置文件生效，使用which命令验证环境变量是否生效"></a>环境变量配置，强烈建议使用.bashrc文件，不要配置.bash_profile，避免不必要的踩坑，并使配置文件生效，使用which命令验证环境变量是否生效</h5><pre><code>export JAVA_HOME=/usr/java/jdk1.8.0_231
export HADOOP_HOME=/bigdata/app/hadoop    
export HIVE_HOME=/bigdata/app/hive
export PATH=$PATH:${JAVA_HOME}/bin:${HADOOP_HOME}/sbin:${HADOOP_HOME}/bin:${HIVE_HOME}/bin
$ source .bashrc
$ which hdfs
$ which hive</code></pre><h5 id="配置ssh信任关系"><a href="#配置ssh信任关系" class="headerlink" title="配置ssh信任关系"></a>配置ssh信任关系</h5><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-keygen -t rsa -P <span class="string">''</span> -f ~/.ssh/id_rsa</span><br><span class="line">$ cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys</span><br><span class="line">$ chmod 0600 ~/.ssh/authorized_keys</span><br></pre></td></tr></table></figure></div>
<h5 id="配置hadoop001免密登录，如果输入yes出来时间就说明信任关系是OK的。如果有问题，说明前面SSH信任配置不对。"><a href="#配置hadoop001免密登录，如果输入yes出来时间就说明信任关系是OK的。如果有问题，说明前面SSH信任配置不对。" class="headerlink" title="配置hadoop001免密登录，如果输入yes出来时间就说明信任关系是OK的。如果有问题，说明前面SSH信任配置不对。"></a>配置hadoop001免密登录，如果输入yes出来时间就说明信任关系是OK的。如果有问题，说明前面SSH信任配置不对。</h5><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh hadoop001 date</span><br></pre></td></tr></table></figure></div>
<h5 id="配置core-site-xml文件，让NN-SNN-DN都以hadoop001用户启动，而不是默认的0-0-0-0启动。"><a href="#配置core-site-xml文件，让NN-SNN-DN都以hadoop001用户启动，而不是默认的0-0-0-0启动。" class="headerlink" title="配置core-site.xml文件，让NN SNN DN都以hadoop001用户启动，而不是默认的0.0.0.0启动。"></a>配置core-site.xml文件，让NN SNN DN都以hadoop001用户启动，而不是默认的0.0.0.0启动。</h5><table>
<thead>
<tr>
<th>简称</th>
<th>全称</th>
</tr>
</thead>
<tbody><tr>
<td>NN</td>
<td>NameNode</td>
</tr>
<tr>
<td>SNN</td>
<td>SecondaryNameNode</td>
</tr>
<tr>
<td>DN</td>
<td>DataNode</td>
</tr>
</tbody></table>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> /bigdata/app/hadoop/etc/hadoop</span><br><span class="line">$ vim core-site.xml</span><br><span class="line">/*将以下内容添加到core-site.xml文件里的configuration标签里*/</span><br><span class="line">  &lt;!--HDFS以hadoop001用户开启服务在9000端口上--&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">     &lt;name&gt;fs.defaultFS&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;hdfs://hadoop001:9000&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">  &lt;!--HDFS临时目录，默认在/tmp/hadoop-<span class="variable">$&#123;user.name&#125;</span>目录下，这个系统临时目录会有30天清理规则或tmp目录已满，会清理，不能配置在系统tmp目录下--&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;hadoop.tmp.dir&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;/bigdata/tmp/&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">  &lt;!--HDFS WebUI访问用户--&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;hadoop.http.staticuser.user&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;hadoop001&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">$ vim slave</span><br><span class="line">/*slave控制DataNode启动用户，改为hadoop001，以这个用户启动DataNode*/</span><br></pre></td></tr></table></figure></div>
<h5 id="配置hdfs-site-xml"><a href="#配置hdfs-site-xml" class="headerlink" title="配置hdfs-site.xml"></a>配置hdfs-site.xml</h5><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">vim hdfs-site.xml</span><br><span class="line">/*将以下内容添加到hdfs-site.xml文件的configuration标签里*/</span><br><span class="line">&lt;!--HDFS副本系数默认为3，由于单机部署，改为1--&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;name&gt;dfs.replication&lt;/name&gt;</span><br><span class="line">	&lt;value&gt;1&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;!--备用namenode的http服务器地址和端口--&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;name&gt;dfs.namenode.secondary.http-address&lt;/name&gt;</span><br><span class="line">	&lt;value&gt;hadoop001:9868&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;!--备用namenode的https服务器地址和端口--&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;name&gt;dfs.namenode.secondary.https-address&lt;/name&gt;</span><br><span class="line">	&lt;value&gt;hadoop001:9869&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt; </span><br><span class="line">  &lt;name&gt;dfs.webhdfs.enabled&lt;/name&gt; </span><br><span class="line">  &lt;value&gt;<span class="literal">true</span>&lt;/value&gt; </span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure></div>
<h5 id="配置mapred-site-xml文件"><a href="#配置mapred-site-xml文件" class="headerlink" title="配置mapred-site.xml文件"></a>配置mapred-site.xml文件</h5><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ cp mapred-site.xml.template mapred-site.xml</span><br><span class="line">/*添加以下代码到mapred-site.xml文件的configuration标签里*/</span><br><span class="line">&lt;!--MapReduce执行框架是Yarn--&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">	&lt;name&gt;mapreduce.framework.name&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;yarn&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">	&lt;name&gt;mapreduce.input.fileinputformat.input.dir.recursive&lt;/name&gt;</span><br><span class="line">	&lt;value&gt;<span class="literal">true</span>&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure></div>
<h5 id="配置yarn-site-xml"><a href="#配置yarn-site-xml" class="headerlink" title="配置yarn-site.xml"></a>配置yarn-site.xml</h5><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">vim yarn-site.xml</span><br><span class="line">/*将以下内容添加到yarn-site.xml文件的configuration标签里*/</span><br><span class="line">&lt;!--启用shuffle处理--&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">	&lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;</span><br><span class="line">	&lt;value&gt;mapreduce_shuffle&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;!--Yarn WebUi网页访问端口，默认为8088，修改为18088，以防止被挖矿--&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">	&lt;name&gt;yarn.resourcemanager.webapp.address&lt;/name&gt;</span><br><span class="line">	&lt;value&gt;hadoop001:18088&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">	&lt;name&gt;yarn.log-aggregation-enable&lt;/name&gt;</span><br><span class="line">	&lt;value&gt;<span class="literal">true</span>&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure></div>
<h5 id="格式化HDFS文件系统"><a href="#格式化HDFS文件系统" class="headerlink" title="格式化HDFS文件系统"></a>格式化HDFS文件系统</h5><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ hdfs namenode -format</span><br><span class="line">/*当出现has been successfully formatted，则格式化成功*/</span><br></pre></td></tr></table></figure></div>
<h5 id="修改hadoop-env-sh、mapred-env-sh、yarn-env-sh文件，默认进程PID文件写在系统tmp目录里，TMP目录有30天清理规则，过期无法执行关闭程序命令，只能kill杀进程。"><a href="#修改hadoop-env-sh、mapred-env-sh、yarn-env-sh文件，默认进程PID文件写在系统tmp目录里，TMP目录有30天清理规则，过期无法执行关闭程序命令，只能kill杀进程。" class="headerlink" title="修改hadoop-env.sh、mapred-env.sh、yarn-env.sh文件，默认进程PID文件写在系统tmp目录里，TMP目录有30天清理规则，过期无法执行关闭程序命令，只能kill杀进程。"></a>修改hadoop-env.sh、mapred-env.sh、yarn-env.sh文件，默认进程PID文件写在系统tmp目录里，TMP目录有30天清理规则，过期无法执行关闭程序命令，只能kill杀进程。</h5><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> /bigdata/app/hadoop/etc/hadoop</span><br><span class="line">$ vim hadoop-env.sh</span><br><span class="line">/** </span><br><span class="line"> <span class="built_in">export</span> JAVA_HOME=/usr/java/jdk1.8.0_231</span><br><span class="line"> <span class="built_in">export</span> HADOOP_PID_DIR=/bigdata/app/hadoop/pids</span><br><span class="line"> <span class="built_in">export</span> HADOOP_SECURE_DN_PID_DIR=<span class="variable">$&#123;HADOOP_PID_DIR&#125;</span></span><br><span class="line">*/</span><br><span class="line">$ vim mapred-env.sh</span><br><span class="line">/* <span class="built_in">export</span> HADOOP_MAPRED_PID_DIR=/bigdata/app/hadoop/pids */</span><br><span class="line">$ vim yarn-env.sh </span><br><span class="line">/* <span class="built_in">export</span> YARN_PID_DIR=/bigdata/app/hadoop/pids */</span><br></pre></td></tr></table></figure></div>
<h5 id="启动hadoop和yarn服务，关闭yarn和hadoop服务"><a href="#启动hadoop和yarn服务，关闭yarn和hadoop服务" class="headerlink" title="启动hadoop和yarn服务，关闭yarn和hadoop服务"></a>启动hadoop和yarn服务，关闭yarn和hadoop服务</h5><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">/*用jps查看服务进程是否存在*/</span><br><span class="line">$ ./start-dfs.sh</span><br><span class="line">$ jps</span><br><span class="line">/*出现NameNode、SecondaryNameNode、DataNode则表示hadoop服务启动正常*/</span><br><span class="line">$ ./start-yarn.sh</span><br><span class="line">$ jps</span><br><span class="line">/*出现NodeManager、ResourceManager则表示yarn服务启动正常*/</span><br><span class="line">$ ./stop-yarn.sh</span><br><span class="line">$ ./stop-dfs.sh</span><br></pre></td></tr></table></figure></div>
<h5 id="执行hadoop命令，验证服务是否正常"><a href="#执行hadoop命令，验证服务是否正常" class="headerlink" title="执行hadoop命令，验证服务是否正常"></a>执行hadoop命令，验证服务是否正常</h5><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ hdfs dfs -ls /</span><br><span class="line">$ hdfs dfs -mkdir /data</span><br><span class="line">$ hdfs dfs -ls /</span><br><span class="line">/* 显示出新创建的目录则表示服务正常 */</span><br></pre></td></tr></table></figure></div>
<h5 id="浏览器验证"><a href="#浏览器验证" class="headerlink" title="浏览器验证"></a>浏览器验证</h5><blockquote>
<p>默认的HDFS-WebUI端口是50070 <a href="http://192.168.0.3:50070" target="_blank" rel="noopener">http://192.168.0.3:50070</a><br>Yarn-WebUI端口是18088 <a href="http://192.168.0.3:18088" target="_blank" rel="noopener">http://192.168.0.3:18088</a><br>Yarn案例验证</p>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> /bigdata/app/hadoop/share/hadoop/mapreduce2</span><br><span class="line">$ hadoop jar hadoop-mapreduce-examples-2.6.0-cdh5.16.2.jar pi 10 100</span><br></pre></td></tr></table></figure></div>
<h1 id="Hive配置"><a href="#Hive配置" class="headerlink" title="Hive配置"></a>Hive配置</h1><blockquote>
<p><a href="/2019/12/25/MySQL5-7单机部署">MySQL5.7单机部署链接</a></p>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># su - mysqladmin</span><br><span class="line">$ mysql -uroot -p</span><br><span class="line">&gt; grant all privileges on *.* to hive@&#39;%&#39; identified by &#39;ruozedata&#39;;</span><br><span class="line">&gt; flush privileges;</span><br></pre></td></tr></table></figure></div>

<h5 id="配置hive-site-xml，hadoop用户操作"><a href="#配置hive-site-xml，hadoop用户操作" class="headerlink" title="配置hive-site.xml，hadoop用户操作"></a>配置hive-site.xml，hadoop用户操作</h5><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">/*将mysql-connector-java驱动包上传到/bigdata/app/hive/lib目录下，用于hive启动连接MySQL数据库*/</span><br><span class="line">$ <span class="built_in">cd</span> /bigdata/app/hive/conf</span><br><span class="line">$ cp /bigdata/app/hadoop/etc/hadoop/core-site.xml hive-site.xml </span><br><span class="line">/*将以下内容添加到hive-site.xml文件的configuration标签里*/</span><br><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;javax.jdo.option.ConnectionURL&lt;/name&gt;</span><br><span class="line">  &lt;value&gt;jdbc:mysql://hadoop001:3306/ruoze_hive?createDatabaseIfNotExist=<span class="literal">true</span>&amp;amp;useSSL=<span class="literal">false</span>&lt;/value&gt;</span><br><span class="line">  &lt;description&gt;the URL of the MySQL database&lt;/description&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;/name&gt;</span><br><span class="line">  &lt;value&gt;com.mysql.jdbc.Driver&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;javax.jdo.option.ConnectionUserName&lt;/name&gt;</span><br><span class="line">  &lt;value&gt;hive&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;javax.jdo.option.ConnectionPassword&lt;/name&gt;</span><br><span class="line">  &lt;value&gt;ruozedata&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;hive.cli.print.current.db&lt;/name&gt;</span><br><span class="line">  &lt;value&gt;<span class="literal">true</span>&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">	&lt;name&gt;hive.server2.thrift.port&lt;/name&gt;</span><br><span class="line">	&lt;value&gt;10001&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">	&lt;name&gt;hive.server2.thrift.bind.host&lt;/name&gt;</span><br><span class="line">	&lt;value&gt;hadoop001&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;name&gt;hive.server2.long.polling.timeout&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;5000&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">	&lt;name&gt;hive.server2.authentication&lt;/name&gt;</span><br><span class="line">	&lt;value&gt;NONE&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure></div>
<h5 id="启动hive并测试"><a href="#启动hive并测试" class="headerlink" title="启动hive并测试"></a>启动hive并测试</h5><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand code-closed" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ nohup hive --service  metastore &gt; /bigdata/<span class="built_in">log</span>/metastore.log 2&gt;&amp;1 &amp;</span><br><span class="line">$ nohup hiveserver2  &gt; /bigdata/<span class="built_in">log</span>/hiveserver2.log 2&gt;&amp;1 &amp;</span><br><span class="line">/*用jps查看服务进程是否存在*/</span><br><span class="line">$ jps -m</span><br><span class="line">/*出现RunJar，运行路径为/bigdata/app/hive则表示服务启动*/</span><br><span class="line">$ beeline</span><br><span class="line">beeline&gt; !connect jdbc:hive2://hadoop001:10000/default</span><br><span class="line">/*默认 hive启动在10000端口号上</span><br><span class="line">默认如果不输入用户名，则user=anonymous，启动报用户没有权限，hive进程，是以hadoop001这个用户启动的，第3，4步，输入hadoop001后，直接回车登录成功</span><br><span class="line">执行show databases;则显示默认数据库default。</span><br><span class="line">通过DBeaver连接测试，开放10000端口，需要两个驱动包，将这两个驱动包下载到DBeaver所在机器，并添加，供DBeaver远程连接hive使用。</span><br><span class="line"> 1) /bigdata/app/hadoop/share/hadoop/common/hadoop-common-2.6.0-cdh5.16.2.jar</span><br><span class="line"> 2) /bigdata/app/hive/lib/hive-jdbc-1.1.0-cdh5.16.2-standalone.jar</span><br><span class="line">*/</span><br></pre></td></tr></table></figure></div>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Starlight</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://brightmoon-s.github.io/2019/12/02/Hadoop%E5%8D%95%E6%9C%BA%E6%90%AD%E5%BB%BA/">https://brightmoon-s.github.io/2019/12/02/Hadoop%E5%8D%95%E6%9C%BA%E6%90%AD%E5%BB%BA/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://brightMoon-s.github.io">浩瀚星空 Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Hadoop/">Hadoop    </a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/wechat.jpg" alt="微信"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/alipay.jpg" alt="支付寶"><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2020/03/06/Spark2-4-5%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85/"><img class="prev_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">上一篇</div><div class="prev_info"><span>Spark2.4.5源码编译安装</span></div></a></div><div class="next-post pull_right"><a href="/2019/02/12/MySQL5-7%E5%8D%95%E6%9C%BA%E9%83%A8%E7%BD%B2/"><img class="next_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>MySQL5.7单机部署</span></div></a></div></nav></div></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By Starlight</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="/js/tw_cn.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script></body></html>